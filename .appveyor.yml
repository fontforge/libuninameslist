image: Visual Studio 2019
platform:
  - x64
branches:
  only:
  - master
clone_depth: 10
environment:
  global:
    MSYSTEM: MSYS
    MBASH: C:\msys64\usr\bin\sh -lc
    PMOPTS: -S --needed --noconfirm --noprogressbar
matrix:
  fast_finish: true

install:
  - call %MBASH% "pacman --noconfirm -S --needed base-devel"
  - call %MBASH% "python -m ensurepip --default-pip"
  - call %MBASH% "python -m pip install setuptools wheel"
before_build:
  - call %MBASH% "cd $APPVEYOR_BUILD_FOLDER"
  - call %MBASH% "autoreconf -fiv"
  - call %MBASH% "mkdir build"
  - call %MBASH% "cd build"
  - call %MBASH% "./configure"
build_script:
  - call %MBASH% "make check -j4 && make install"
test: off
artifacts:
  - path: build\py\wheel\*.whl
    name: libuninameslist
